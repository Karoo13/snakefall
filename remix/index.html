<html>
  <head>
    <title>Snakefall</title>
    <meta name="color-scheme" content="dark light"/>
    <meta name="viewport" content="interactive-widget=overlays-content"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <style>
      * {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
      }
      :root {
        color-scheme: light;
        --bg: #fff;
        --fg: #000;
        --ta-fg: #000;
      }
      :root[data-theme="light"] {
        color-scheme: light;
        --bg: #fff;
        --fg: #000;
        --ta-fg: #000;
      }
      :root[data-theme="dark"] {
        color-scheme: dark;
        --bg: #2c3034;
        --fg: #eee;
        --ta-fg: #bbb;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          color-scheme: dark;
          --bg: #2c3034;
          --fg: #eee;
          --ta-fg: #bbb;
        }
      }
      body {
        background: var(--bg);
        color: var(--fg);
      }
      button {
        padding: 1px 3px;
      }
      textarea {
        background: var(--bg);
        color: var(--ta-fg);
      }
      .material-symbols-outlined {
        position: absolute;
        background-color: #0ff4;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: inherit;
      }
    </style>
  </head>
  <body style="touch-action:manipulation; min-width:max-content; padding:6px">
    <table style="margin:6px auto;"><tr>
      <td><canvas id="canvas" width=750 height=600 style="touch-action:pinch-zoom;"></canvas></td>
      <td id="editorPane" style="display:none;">
        <table style="margin-left:6px;">
          <tr><td><button onpointerdown="event.preventDefault();" id="saveLevelButton" title="Ctrl+Shift+S - save the current state to the browser URL bar, clears move history">Save Level</button></td></tr>
          <tr><td>
            <button onpointerdown="event.preventDefault();" id="uneditButton" title="Ctrl+Z" disabled>Unedit &lt;&lt;</button>
            <button onpointerdown="event.preventDefault();" id="reeditButton" title="Ctrl+Shift+Z, Ctrl+Y" disabled>&gt;&gt; Re-edit</button><br>
            Edits: <span id="editsSpan">0+0</span>
          </td></tr>
          <tr><td>
            <button onpointerdown="event.preventDefault();" id="resizeUButton" title="A - drag grid to add rows/cols">Grow</button>
            <button onpointerdown="event.preventDefault();" id="resizeDButton" title="Shift+A - drag grid to remove rows/cols">Shrink</button>
          </td></tr>
          <tr><td>
            <button onpointerdown="event.preventDefault();" id="selectButton" title="Shift+S - select an area, then cut, copy, delete or fill">Select</button><button onpointerdown="event.preventDefault();" id="selectAllButton" title="Ctrl+A - select all">A</button><br>
            <button onpointerdown="event.preventDefault();" id="cutButton" title="Ctrl+X - cut selection" disabled>X</button><button onpointerdown="event.preventDefault();" id="copyButton" title="Ctrl+C - copy selection" disabled>C</button><button onpointerdown="event.preventDefault();" id="pasteButton" title="Ctrl+V - paste selection" disabled>V</button>
          </td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintSpaceButton" title="E, Delete">Erase</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintWallButton" title="W">Wall</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintSpikeButton" title="S">Spike</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintExitButton" title="X">Exit</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintFruitButton" title="F">Fruit</button>
                  <button onpointerdown="event.preventDefault();" id="paintPoisonFruitButton" title="Shift+F">Poison</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintPortalButton" title="P">Portal</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintSnakeButton" title="N - select again to change color">Snake</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintBlockButton" title="B - select again to finish placing">Block</button></td></tr>
          <!-- <tr><td><button onpointerdown="event.preventDefault();" id="paintPlatformButton" title="U - solid to the edges of snakes and blocks">Platform</button></td></tr> -->
          <tr><td><button onpointerdown="event.preventDefault();" id="paintPlatformUButton" title="U - solid to the edges of snakes and blocks">PlatformU</button><br>
                  <button onpointerdown="event.preventDefault();" id="paintPlatformLButton" title="H - PlatformL">L</button><button onpointerdown="event.preventDefault();" id="paintPlatformDButton" title="J - PlatformD">D</button><button onpointerdown="event.preventDefault();" id="paintPlatformRButton" title="K - PlatformR">R</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintWoodPlatformButton" title="Shift+U - platform that can be pushed through">WoodPlatform</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintDiggableDirtButton" title="D - can be dug through like fruit">Dirt</button>
                  <button onpointerdown="event.preventDefault();" id="paintFoamButton" title="Shift+D - can be pushed or teleported into">Foam</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="paintOpenGateButton" title="O - closes when no longer occupied">OpenGate</button><br>
                  <button onpointerdown="event.preventDefault();" id="paintClosedGateButton" title="Shift+O - behaves like a wall">ClosedGate</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="cheatGravityButton" title="Shift+G">Gravity: ON</button></td></tr>
          <tr><td><button onpointerdown="event.preventDefault();" id="cheatCollisionButton" title="Shift+C">Collision: ON</button></td></tr>
        </table>
      </td>
    </tr></table>

    <table style="margin:0px auto; text-align:center;">
      <tr><td>
        <div id="paradoxDiv" style="background:#f88;"></div>
        Arrows<span id="wasdSpan">/WASD</span> to move
        <button onpointerdown="event.preventDefault();" id="switchSnakesButton" title="(Shift+)Spacebar, (Shift+)Tab, digits, or click with no edit tool (Esc)">Switch Snakes</button>
        <button onpointerdown="event.preventDefault();" id="showGridButton" title="G">Show Grid</button>
        <button onpointerdown="event.preventDefault();" id="touchControlsButton" title="enable an overlay for touch devices">Touch Input</button>
      </td></tr>
      <tr><td>
        <button onpointerdown="event.preventDefault();" id="unmoveButton" title="Z, Q, Backspace" disabled>Unmove &lt;&lt;</button>
        Moves: <span id="movesSpan">0+0</span>
        <button onpointerdown="event.preventDefault();" id="removeButton" title="Y, E with editor hidden, Shift+Z, Shift+Q, Shift+Backspace" disabled>&gt;&gt; Re-move</button>
        <button onpointerdown="event.preventDefault();" id="restartButton" title="R - unmove to beginning, Shift+R - re-move to end">Restart</button>
        <button onpointerdown="event.preventDefault();" id="saveProgressButton" title="Ctrl+S - save past moves to the browser URL bar, can not save if editor tools were used since the last level save">Save Progress</button>
      </td></tr>
    </table>

    <table>
      <tr><td><button onpointerdown="event.preventDefault();" id="showHideEditor" title="Shift+E">Show Editor</button>
              <button onpointerdown="event.preventDefault();" id="toggleDarkLight">Dark</button></td></tr>
      <tr><td>
        <div id="editorDiv" style="display:none;">
          <textarea id="serializationTextarea" rows=30 cols=80></textarea>
          <div>
            <button onpointerdown="event.preventDefault();" id="submitSerializationButton" title="load the text-representation of a level">Submit</button>
            Share link: <input id="shareLinkTextbox">
          </div>
        </div>
      </td></tr>
    </table>

    <div style="margin-top:1em;">This project on Github: <a href="https://github.com/Karoo13/snakefall/">Karoo13/snakefall</a> version <span id="versionSpan">???</span></div>
    <div>Check out some <a href="https://github.com/thejoshwolfe/snakefall/wiki/">community made levels</a>, and share your levels there!</div>
    <div>This is the enhanced version featuring several new puzzle elements.</div>
    <div>This game is a clone of <a href="https://store.steampowered.com/app/357300/Snakebird/">Snakebird</a> by Noumenon Games.</div>

    <div id="visualViewportMirror" style="position:fixed; visibility:hidden; font-size:3vh;">
      <div id="touchControls" onselectstart="event.preventDefault();" oncontextmenu="event.preventDefault();" style="touch-action:pan-x pan-y; position:absolute; top:52%; left:0%; bottom:0%; right:0%; font-family:'Material Symbols Outlined'; visibility:hidden;">
        <div style="position:absolute; top:0%; left:-50%; bottom:-50%; right:-50%; background-color:#000c;"></div>
        <div id="touchUnmoveButton"  class="material-symbols-outlined" style="top:1%;  left:0%;  height:20%; width:36%; touch-action:none;">undo</div>
        <div id="touchRestartButton" class="material-symbols-outlined" style="top:1%;  left:37%; height:20%; width:26%;">skip_previous</div>
        <div id="touchRemoveButton"  class="material-symbols-outlined" style="top:1%;  left:64%; height:20%; width:36%; touch-action:none;">redo</div>
        <div id="touchUpButton"      class="material-symbols-outlined" style="top:22%; left:0%; height:20%; width:100%;">keyboard_arrow_up</div>
        <div id="touchLeftButton"    class="material-symbols-outlined" style="top:43%; left:0%;  height:20%; width:36%;">keyboard_arrow_left</div>
        <div id="touchSwitchButton"  class="material-symbols-outlined" style="top:43%; left:37%; height:20%; width:26%;">swap_horiz</div>
        <div id="touchRightButton"   class="material-symbols-outlined" style="top:43%; left:64%; height:20%; width:36%;">keyboard_arrow_right</div>
        <div id="touchDownButton"    class="material-symbols-outlined" style="top:64%; left:0%; height:20%; width:100%;">keyboard_arrow_down</div>
        <div id="touchGridButton"    class="material-symbols-outlined" style="top:85%; left:0%;  height:15%; width:36%;">grid_3x3</div>
        <div id="touchHideButton"    class="material-symbols-outlined" style="top:85%; left:37%; height:15%; width:26%;">keyboard_double_arrow_down</div>
        <div id="touchSaveButton"    class="material-symbols-outlined" style="top:85%; left:64%; height:15%; width:36%;">save</div>
      </div>
    </div>

    <script src="a.js"></script>
  </body>
</html>
